---
typora-root-url: F:\Users\tian\Pictures\linux图库
---

[TOC]

#  网络基础概述

## 网络协议：

所谓协议，就是规则的集合，是一种标准，最简单的比喻，我们生活中使用的语言，别人说一句话，你能听懂他表达的是什么意思，这就叫你们两个人遵循同一种协议，能基于这个协议进行交流，反之，如果你不懂英语，别人用英语和你说话，你就明白不了他要表述的意思！

网络协议，就是这么一种标准，它规定了计算机交流中使用的语言格式，计算机之间该如何理解对方传输过来的数据

而一门语言在那里，都必须要有人使用它达到交流的目的，对应到计算机中，每个协议，都必须要有特定的应用程序来使用它，我们称之为协议的实现！，没人使用这个规则进行交流，那这个规则也就放在那里看一看了，不悲不喜！

### OSI协议栈和TCP/IP协议栈

先解释一下，什么是栈，在计算机中，有一种数据结构，我将它形象的比喻成牛角尖，大家经常喜欢钻牛角尖对吧，这个牛角尖,不倒退，是没有出路的，来我们想象一下，很多人一起钻牛角尖是个什么场景呢？ 嗯，先钻进去的人被后钻进去的人挤着出不来，这就是和栈这个原理差不多了，往栈中存放一堆数据，先进去的数据，是取不出来的，得一层一层的将它上面的数据取出来，才能把目标数据逮出来。

基于以上概念，我们来讲协议栈

* OSI协议栈

  这个协议栈，就是一堆协议的模型，它分为七层，从上至下 分别为**应用层、表示层、会话层、传输层、网络层、数据链路层以及物理层**，为什么要这么分层呢？ 因为计算机间的数据传送是一个极为复杂的过程，分层的目的是将大问题拆分成n多个小问题，逐个击破，他们互相协调，彼此独立，一层出现问题，不会影响到其他层！

  这个协议栈由这些层次组成，现在，我们拿一个浏览器访问网站的示例来简述一下他的工作流程，

  我们浏览器中输入一个网址后（浏览器就是前面所说的，实现某个协议的特定应用程序，它一般能实现应用层的https，ftp等协议），使用https协议，将其封装起来，加个应用层首部，说白了就是按照该协议的语法格式，将你请求的网络地址打包起来，而后往下一层扔，每一层都按照各层的协议标准，组织一下数据，添油加醋，加个首部，继续往下扔，最后到物理层，它会将你的数据组织成二进制格式的流式化数据，通过网线，发送到目标主机，怎么知道目标主机的？ 这就是各层次之间协议该干的的事情了，到目标主机后，便按照前面的层次由下至上，一层一层能的把数据剥开还原，是不是很想钻牛角尖的过程呢，至少我是这么认为的，最终送达到目标服务器上的某个服务类程序，根据你的请求，将你要的数据，通过前面一样的过程，返回到你的浏览器程序上来！

  但是，由于该协议标准太严格，太过于重量级，以至于，该模型被沦为学习模型，现实中基本上用到的很少

* TCP/IP协议栈

  这个协议栈才是我们目前网络社会上正在使用的协议栈，它将OSI协议栈简化成为四层，他们的对应关系和常用协议，如下图所示

  ![tcp_ip](/tcp_ip.png)

  * **注意**  从传输层开始，往下，包括传输层，我们统称为**通信子网** 它主要负责数据的通信，例如标识源地址，目标地址，拆分控制等功能

    上面三层或者说一层，则统称为资源子网，它主要负责数据的组织格式

  

## MAC地址和IP地址详解

早期的网络，是基于同轴线缆的以太网，所谓同轴线缆，表示所有计算机都连接到一条主电缆中，各主机之间的信息交互，都基于这么一条电缆，所以问题来了，当线缆连接的计算机数量很多时，势必会造成信号冲突，以至于通信失败。 为了解决这一冲突，就出现了不同的技术方案，列举两个

* 以太网：这是一种局域网技术，它实现的步骤是，开始发送数据前，先检测线路是否被占用，如果占用，则继续等待，如果空闲，则开始发送，发送过程中也持续探测冲突，如果发现有其他计算机需要使用，在保证数据完整性的同时，尽快腾出线路给其他计算机使用，自己则继续等待至空闲！范围内的所有主机都基于这个技术，所以不用担心有计算机霸占着线路不让！这就是以太网，也是我们目前最常见的局域网通信技术
* 令牌反网：该技术的实现方式是，一个令牌在电缆中持续游走，哪台计算机需要发送数据，只有将其捕获，才能有权利发送数据，其他人都无权占用线缆

为了降低线缆中的冲突，我们可以在电缆上，加装一个网桥（现在也叫它交换机），它的作用是，隔开两个网络之间的连接，避免局部区域计算机数量太多，冲突时间太长，如图所示

![交换机连接图](/交换机连接图.png)

当A主机要发送数据给C主机时，交换机能检测到C主机就左边网络中，因此它将信号不转发到2号接口，而当A主机要发送数据给a主机时，交换机能检测到a主机的网卡地址在2号端口，因此它能将信号转发到右边网络，以此实现减少冲突的目的，这种方式，还是可以进行广播的，所谓广播，就是一台机器大汉一嗓子，它的数据能被所有主机收到，当网络中的主机数量增多时，势必要限制广播信号的传递区域。

所以，路由器出现了，路由器能够阻断广播信号，对其置之不理，以我目前的理解，能接受到同一个广播信号的区域，就是一个本地网络，如下图所示：

![交换机-路由器](/交换机-路由器.png)

当A发出广播时，路由器上面的所有主机都能接受到，下面则被路由器阻断了，但是A如果需要发送数据给A1，那么信号会送达路由器一号端口而后被转发送达到路由器2号端口

基于这些概念，就可以开始讲讲MAC地址和IP地址了

#### MAC地址

网卡是一个硬件设备，它的功能是实现本地局域网中，计算机之间的通信，为了能够顺利通信，每一块网卡都必须有一个全球唯一的地址标识，这个地址标识，就叫MAC地址，基于MAC地址，就可以在本地局域网中，通过以太网技术进行通信了！前面所说的交换机，便是基于MAC地址，判断主机是否在其网络中的，交换机能够记录端口两端的各主机的MAC地址！

**注意** ：每块网卡的MAC地址长度为48bit，由网卡厂商烧录进去，固定不变的，为了保证MAC地址的全球唯一性，所有生产网卡的厂商都必须向ICANN组织申请购买前24bit地址，买到之后，前24bit不变，后24bit则可以自由变化，只要保证不会有重名网卡产生即可

MAC只用于实现局域网之间的通信而不能跨网络的原因是，各主机使用的网卡，命名是毫无规则的，可能是不同厂家生产的，而网络中主机的数量是非常庞大的，所以，需要划分出层级结构，便于查找定位，因此，IP地址就出现了！



#### IP地址

IP地址，只是一个逻辑地址，它存在的目的，仅是方便路由器根据其IP地址，寻找到目标MAC地址，屏蔽MAC地址的差异！实际上，数据的传输，只是通过ip地址定位，而后靠一段一段的本地通信进行接力完成的

IP地址由长度为32bit的二进制数组成，格式是没8bit一组，使用.号隔开，一般使用对应的十进制数表示，例如11111111.11111111.11111111.00000000对应为十进制就是255.255.255.0

根据网络号的长度，又将其划分成了五个类别，分别是

* A类：第一段网络号，后三段主机号

  网络号：第一位固定不变为零：0 000 0000-0 111 11111（1-127），只有126可用，127被当做本地回环地址了

  主机号中，全0表示网络自身（网络地址），全1表示全部主机（广播地址）

  默认子网掩码：255.0.0.0  与ip地址按位进行“与”运算，从而取出网络地址

  私网地址：只能在本地有限的范围通信：10.0.0.0/255.0.0.0

* B类：前两段为网络号，后两段为主机号

  网络号：前两位固定为10： 10 00 0000-10 111 1111:128-191

  网络数：2^14个

  每个网络中的主机数量：2^16-2

  默认子网掩码：255.255.0.0

  私网地址：172.16.0.0-172.31.0.0

* C类：前三段为网络号，最后一段为主机号

  网络号：前三位固定为110： 110 0 0000-110 0 0000： 192-223

  网络数：2^21

  每个网络中的主机数量：2^8-2

  默认子网掩码：255.255.255.0    /24（1的个数）

  私网地址：192.168.0.0-192.168.255.255

* D类：组播

  1110 0000-1110-1111:224-239

* E类：科研

  240-255

