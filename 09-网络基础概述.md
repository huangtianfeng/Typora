---
typora-root-url: F:\Users\tian\Pictures\linux图库
---

[TOC]

#  网络基础概述

## 计算机网络

计算机网络，是一个发展中的概念和技术，广义上，我们将网络理解为一个组合形式，例如，两台电脑主机之间通过一种介质相连接，就构成了一个最简单的网络，网络存在的目的，是使用一定的通信线路，将地理位置相对分散的计算机连接起来，在一定的通信协议的约束与控制下，实现资源共享和数据交换

计算机网络由硬件部分和软件部分组成，其中硬件部分包括1.计算机终端设备，2.网络设备，3.传输介质。软件部分包括1.计算机软件，2.网络设备软件，3.计算机和网络设备中的网络通信协议

从英特网的工作方式来看，计算机网络可以分为两大部分：

1. 边缘部分：由所有连接在因特网上的主机组成，这部分直接使用网络完成资源共享和数据交换
2. 核心部分：由大量网络和连接他们的路由器设备组成，为边缘部分提供网络服务

这样划分，除了提供数据通信，资源共享和数据处理的基本功能外，还额外提高了计算机的高可用性，避免单个中心节点故障导致整个网络瘫痪，以及实现负载均衡，协同处理，分布式计算等功能

而从网络的作用范围来划分，又分为如下几种网络：

1. 局域网：LAN Local Area Network

2. 城域网：MAN Metropolitan Area Network

3. 广域网：WAN Wide Area Network

4. 个人区域网：PAN Personal Area Network

   我们的互联网就是WAN广域网，而家庭中使用的wifi构建的就是一个局域网，城域网，一般我们的各省市的移动，电信运营商就能构成城域网，至于个人区域网，我们生活中用到的蓝牙，无线鼠标之类的个人设备，就属于这种了。

按照使用者的分类，还可以分为

1. 公用网：Public Network

2. 专用网：Private Network

   例如，为了保证数据的严密性，架设的VPN专线，通过协议打通一个专用通道！

## 计算机网络的拓扑结构

计算机网络拓扑图就相当于建筑行业的建筑图纸，借用拓扑结构这个概念来描述网络系统中节点间的相互关系

将设备实体抽象成为节点，用不同符号表示，将通讯链路抽象成线条，节点通过线条连接而成的集合图形就是网络的拓扑结构

拓扑结构，又分为很多类型

1. 星型拓扑结构：

   网络中所有节点通过各自的通信线路连接到 一个中心节点设备上

   特点：

   节点扩展和移除方便，但是不能超过中心节点所提供的端口数

   网络传输数据块，维护方便。

   中心节点负载大，广播传输影响网络传输

2. 环形拓扑结构：

   所有节点都接在一条首尾相连的封闭的通信线路上，通过T形接口连接主机

   特点：

   网络路劲选择和网络组建简单

   投资成本低，只需要购置T型接口加同轴线缆即可

   传输速度慢，效率低

   扩展性差，维护困难

3. 总线拓扑结构

   所有节点都连接在一条开放的通信线路上，两端连接两个信号控制器

   特点：

   网路结构简单，扩展容易

   传输速率低，故障诊断困难

4. 树形拓扑结构

   类似于总线拓扑结构的局域网拓扑，可包含分支，每个分支可包含多个节点，结合了总线形拓扑和星形拓扑结构

5. 网状拓扑结构

   各节点互相连接，并且每个节点至少与其他两个节点相连，广域网就是用的该结构

6. 混合形拓扑结构

   使用中心交换机连接多个不同的拓扑结构

## 网络通信协议：

网络通信协议是网络通信的基础，是实现各种网络通信功能，约束通信双方在利用某协议进行通信时，必须遵从的通信规则和约定的软件系统。通信协议既可以是一些有国际标准组织颁布的通用标准协议，如（ISO,IEEE,IEC等），也可以是一些企业自己开发出来的私有协议，如TCP IP，等等

最简单的比喻，我们生活中使用的语言，别人说一句话，你能听懂他表达的是什么意思，这就叫你们两个人遵循同一种协议，能基于这个协议进行交流，反之，如果你不懂英语，别人用英语和你说话，你就明白不了他要表述的意思！

网络协议，就是这么一种标准，它规定了计算机交流中使用的语言格式，计算机之间该如何理解对方传输过来的数据

而一门语言在那里，都必须要有人使用它达到交流的目的，对应到计算机中，每个协议，都必须要有特定的应用程序来使用它，我们称之为协议的实现！，没人使用这个规则进行交流，那这个规则也就发挥不了任何作用。

#### 通信协议的三要素：

1. 语义：描述具体完成什么功能
2. 语法：规定通稀释的信息格式，解决“如何做”的问题
3. 同步：解决“做的次序”，依据什么样的流程，匹配什么样的速率，什么样的电平来进行

## OSI/RM和TCP/IP

计算计网络体系结构，是一个分层次的模块结构

1. 每层都有特定的协议，促进标准化
2. 各层互相独立，技术升级和扩展灵活性好
3. 便于方案设计和维护

OSIRM简称OSI ， 开放系统互联基本参考模型，他是一个开放的，非独家垄断的呃一个抽象概念模型，也是所谓的七层协议的体系结构（IOS标准）

TCP/IP体系结构是专门针对使用TCP/IP协议族的广域计算机网络而开放的，是OSI/RM的改进版本，也是目前被广泛使用的参考模型！ 

![插图09-1](/../../../../../../../../Pictures/linux图库/插图09-1.png)

二者的层次结构划分思想相同，总体层次结构相似，核心组成以一样，但是使用范围不同，纯支持的网络通信模式不同，所包括的通信协议也不同！

对等层之间传送的数据单位称之为PDU（协议数据单元）

物理层：以最原始的比特流传输，其PDU为**比特**

链路层：传输单位是帧，一个**帧**包括多个比特，一个帧的大小必须是一个整数字节，不同协议的帧，大小不一

网络层：传输的单位是**分组**（或者是**包**），一个分组可以包含多个帧

传输层：TCP是以**数据段**为单位传输，UDP以数据**包**为单位传输

会话，表示，应用层：以具体的数据报文为单位进行传输！

#### 协议头和协议尾的封装

在整个传输过程中，数据在发送端时，经过各层时都附加上相应层的协议头和协议尾（仅数据链路层需要封装协议尾）部分，也就是对数据进行协议封装，以标识对应层所用的通信协议。

## MAC地址和IP地址

早期的网络，是基于同轴线缆构建的，所谓同轴线缆，表示所有计算机都连接到一条主电缆中，各主机之间的信息交互，都基于这么一条电缆，所以问题来了，当线缆连接的计算机数量很多时，势必会造成信号冲突，以至于通信失败。 为了解决这一冲突，就出现了不同的技术方案，列举两个

* 以太网：这是一种局域网技术，它实现的步骤是，开始发送数据前，先检测线路是否被占用，如果占用，则继续等待，如果空闲，则开始发送，发送过程中也持续探测冲突，如果发现有其他计算机需要使用，在保证数据完整性的同时，尽快腾出线路给其他计算机使用，自己则继续等待至空闲！范围内的所有主机都基于这个技术，所以不用担心有计算机霸占着线路不让！这就是以太网，也是我们目前最常见的局域网通信技术
* 令牌反网：该技术的实现方式是，一个令牌在电缆中持续游走，哪台计算机需要发送数据，只有将其捕获，才能有权利发送数据，其他人都无权占用线缆

为了降低线缆中的冲突，我们可以在电缆上，加装一个网桥（现在也叫它交换机），它的作用是，将一个局域网切分为多个网络，阻断冲突域

![交换机连接图](/交换机连接图.png)

当A主机要发送数据给C主机时，交换机能检测到C主机就左边网络中，因此它将信号不转发到2号接口，而当A主机要发送数据给a主机时，交换机能检测到a主机的网卡地址在2号端口，因此它能将信号转发到右边网络，以此实现减少冲突的目的，这种方式，还是可以进行广播的，所谓广播，就是一台机器大汉一嗓子，它的数据能被所有主机收到，当网络中的主机数量增多时，势必要限制广播信号的传递区域。

所以，路由器出现了，路由器能够阻断广播信号，对其置之不理，以我目前的理解，能接受到同一个广播信号的区域，就是一个本地网络，如下图所示：

![交换机-路由器](/交换机-路由器.png)

当A发出广播时，路由器上面的所有主机都能接受到，下面则被路由器阻断了，但是A如果需要发送数据给A1，那么信号会送达路由器一号端口而后被转发送达到路由器2号端口

基于这些概念，就可以开始讲讲MAC地址和IP地址了

#### MAC地址

网卡是一个硬件设备，它的功能是实现本地局域网中，计算机之间的通信，为了能够顺利通信，每一块网卡都必须有一个全球唯一的地址标识，这个地址标识，就叫MAC地址，基于MAC地址，就可以在本地局域网中，通过以太网技术进行通信了！前面所说的交换机，便是基于MAC地址，判断主机是否在其网络中的，交换机能够记录端口两端的各主机的MAC地址！

**注意** ：每块网卡的MAC地址长度为48bit，由网卡厂商烧录进去，固定不变的，为了保证MAC地址的全球唯一性，所有生产网卡的厂商都必须向ICANN组织申请购买前24bit地址，买到之后，前24bit不变，后24bit则可以自由变化，只要保证不会有重名网卡产生即可

MAC只用于实现局域网之间的通信而不能跨网络的原因是，各主机使用的网卡，命名是毫无规则的，可能是不同厂家生产的，而网络中主机的数量是非常庞大的，所以，需要划分出层级结构，便于查找定位，因此，IP地址就出现了！



#### IP地址

IP地址，只是一个逻辑地址，它存在的目的，仅是方便路由器根据其IP地址，寻找到目标MAC地址，屏蔽MAC地址的差异性！实际上，数据的传输，只是通过ip地址定位，而后靠一段一段的本地通信进行接力完成的

IP地址由长度为32bit的二进制数组成，格式是没8bit一组，使用.号隔开，一般使用对应的十进制数表示，例如11111111.11111111.11111111.00000000对应为十进制就是255.255.255.0

根据网络号的长度，又将其划分成了五个类别，分别是

* A类：第一段网络号，后三段主机号

  网络号：第一位固定不变为零：0 000 0000-0 111 11111（1-127），只有126可用，127被当做本地回环地址了

  主机号中，全0表示网络自身（网络地址），全1表示全部主机（广播地址）

  默认子网掩码：255.0.0.0 

  私网地址：只能在本地有限的范围通信：10.0.0.0/255.0.0.0

* B类：前两段为网络号，后两段为主机号

  网络号：前两位固定为10： 10 00 0000-10 111 1111:128-191

  网络数：2^14个

  每个网络中的主机数量：2^16-2

  默认子网掩码：255.255.0.0

  私网地址：172.16.0.0-172.31.0.0

* C类：前三段为网络号，最后一段为主机号

  网络号：前三位固定为110： 110 0 0000-110 0 0000： 192-223

  网络数：2^21

  每个网络中的主机数量：2^8-2

  默认子网掩码：255.255.255.0    /24（1的个数）

  私网地址：192.168.0.0-192.168.255.255

* D类：组播

  1110 0000-1110-1111:224-239

* E类：科研

  240-255

#### 子网划分

说子网划分前，先了解一下子网掩码是什么。 

子网掩码，是一组由1和0组成的和ip地址长度一样的二进制数！它不是ip地址，它的值，只会由连续的n个1开头和连续的n个0结尾组成！ 它的作用在于，将一个网络地址划分为两个部分，网络号和主机号，1的长度，决定了ip地址中网络号的长度，剩下的即为主机号，例如，192.168.0.0/24 ，这个24表示该网络中，有24位网络号。剩余的8位为该网络中的主机号！

计算机在进行通信时，会将目标ip地址和本机所在网络的子网掩码做与运算，我们知道，1与任何数得任何数，0与任何数得0，所以，这样将取出网络号，然后拿目标地址的网络号和本机所在网络的网络号做比较，如果网络号相同，则表示，是本地通信，否则，是网络通信

子网划分即将一个网路，划分为多个小网络，彼此独立，有各自的网络号和广播地址！例如，我们见到过的最多的私网地址，192.168.0.0/24 ,这是一个c类网络，通过前面所述，我们知道，在该网络中，192.168.0.0是该网络的网络号，192.168.255.255是该网络的广播地址，192.168.0.1-192.168.0.254,是该网络中可用的ip地址，现在，我们需要在该网络中，划分出两个小网络，彼此独立，该怎么办呢？ 我们现在知道，在192.168.0.0/24 这个网络中有效地址范围为192.168.0.0-192.168.0.255，前三段网络号已经被固定，要想在此基础上划分出子网，就需要找主机号借位，用来充当网络号，因为这些数其实是二进制的，所以，借的位数，就决定了划分出的子网个数，例如，在前面三段网络号固定的基础上，在第四段的主机号上，借一位，那么该网段中网络号，便多出来两种变化，0和1，借两位，就多出四种变化，00,01,10,11， 依此类推，借n位当网络号，网络号就多出2的n次方个变化，也即是划分出多少个子网！

综上所述，在192.168.0.0/24这个网络中，划分出两个子网，只需要借一位主机号当网络号即可，划分成192.168.0.0/25和192.168.0.128/25， 这里的128怎么来的呢？ 第一个192.168.0.0是前一个子网中的网络号，也就是借来的一位为0时的情况，此时该网络中的有效地址范围为00000000-011111111,也就是十进制的0-127，而后面的192.168.0.128，表示，借来的网络号为1时的情况，此时，该子网络中的有效地址范围为10000000-11111111，也就是十进制的128-255！ 

示例：求100.0.0.16/28对应网段的网关地址，广播地址以及可分配的ip地址范围！

第一步：确认子网掩码长度为28

第二步：确认该网段的网络号，将100.0.0.16转换为二进制和掩码做与运算得到网络号，这里28大于24，也就是说，前三个字段不变，只需要确认第四个字段的网络号是什么，用16（00010000）和（11110000）做与运算，得出值为00010000不变，所以该网段的网络号为100.0.0.16

第三步：网络位不变，主机位全零的地址，表示该网段的网关地址，主机号全1的地址，表示该网段的广播地址，那么该网段，由前面一步我们知道，其主机号为后四位，也就是说，该网段的网关地址为100.0.0.16（00010000），广播地址为100.0.0.31（00011111）

第四步：该网段的可分配地址为网关地址和广播地址之间的所有合法ip，也就是100.0.0.17-100.0.0.30

